---
layout: single
title: "[정처기] 소프트웨어 개발 보안 구현"
categories: 
    - EIP
tags: 
    - [정처기, 정처기실기]
toc: true
toc_sticky: true
---

# 📂 시큐어 코딩 가이드 ⇒ <b><span style='color:#2D3748; background-color:#fff5b1'>입보시 에코캡아</span></b>
 : 잠재적인 보안 취약점을 사전에 제거하고 안전한 소프트웨어 개발하는 기법

1. 입력 데이터 검증 및 표현
    - 방안 : 입력 데이터의 유효성 검증
2. 보안 기능
    - 방안 : 인증, 접근통제, 권한관리, 비밀번호 정책
3. 시간 및 상태 (병렬 시스템에서의 관리)
    - 방안 : 공유 자원의 접근 직렬화, 병렬 실행 가능 프레임워크 사용, 블록문 내에서만 재귀함수 호출
4. 에러 처리
    - 방안 : 잘 설계
5. 코드오류
    - 방안 : 코딩규칙 도출 → 검증 가능한 스크립트 구성, 경고 순위의 최상향 조정
6. 캡슐화
    - 방안 : 디버거 코드 제거, private 접근자 지정
7. API 오용
    - 방안 : 취약API 확보, 검출 프로그램 사용

<br>

## 📝 입력 데이터 검증 및 표현

### 📌 XSS (Cross Site Scripting)
 : 검증되지 않은 외부 입력 데이터가 포함된 <b><span style='color:#006DD7'>웹페이지 열람</span></b> → 부적절한 스크립트 실행

- 공격유형
   1. Stored XSS
    : 악성 스크립트 포함된 <u>페이지 읽음</u>과 동시에 브라우저에서 실행되며 감염
   2. Reflected XSS
    : 공격용 악성 <u>URL</u>을 이메일로 발송 → 클릭하면 공격 스크립트가 피해자로 반사되어 공격자에게 정보 전송
   3. DOM XSS
    : DOM 기반 XSS 취약점 브라우저 대상 → 조작된 <u>URL</u> 이메일 발송 → 클릭 시 피해
- 대책 : 특수문자 필터링, HTML 태그 사용 금지, JS로 시작하는 문자열은 문자열 변환처리

### 📌 사이트 간 요청 위조 (CSRF; Cross-Site Request Forgery)
 : <b><span style='color:#006DD7'>사용자 의지와 무관</span></b>하게 <b><span style='color:#006DD7'>공격자가 의도한 행위</span></b>를 특정 웹사이트에서 요청하게 하는 공격

- 공격방식
  1. 공격자 : CSRF 스크립트가 포함된 게시물 등록
  2. 사용자 : CSRF 스크립트 포함된 페이지의 게시물 열람 요청
  3. 게시물을 읽은 사용자 권한으로 공격자가 원하는 요청 발생
- 대책
  - 입력화면 폼 작성 시 GET 방식 대신 POST 방식 사용
  - 입력폼과 입력처리 프로그램에서 세션별 CSRF 토큰으로 점검
  - 중요 기능이면 재인증으로 안전한 실제 요청 여부 확인

### 📌 SQL Injection
 : <b><span style='color:#006DD7'>악의적 SQL 구문 삽입, 실행</span></b> → DB 접근으로 정보 탈취

- 공격유형
  1. Form SQL Injection (사용자 인증 쿼리문의 조건 조작)
  2. Union SQL Injection
  3. Stored Procedure SQL Injection
  4. Mass SQL Injection (대량의 DB 값 변조)
  5. Error-Based SQL Injection (에러값 기반으로 정보획득)
  6. Bling SQL Injection (쿼리 결과의 참/거짓)
- 대책
  - 바인딩 매개변수 방식 적용 → 사전에 변수 타입 명시
  - 입력될 수 있는 모든 값 체크 → 필터링
  - 자바 : Servlet filter 기능 적용

<br>

## 📝 보안 기능

1. 적절한 인증 없이 중요 기능 허용 (보안 우회)
 → 재인증 기능
2. 부적절 인가 (접근제어 기능이 없는 실행경로)
 → 모든 실행경로에 접근제어 검사 수행. 사용자에게 필요한 접근권한만 부여
3. 취약한 암호화 알고리즘
 → 안전한 암호화 알고리즘, 안정성 인증된 암호 모듈 이용
4. 중요 정보 평문 저장 및 전송
 → 암호화 거치기. HTTPS, SSL/TLS 등 보안채널 이용
5. <b><span style='color:#006DD7'>하드 코드 된 비밀번호 </span></b>(코드 내부에 패스워드 포함)
 → 패스워드는 암호화해서 별도 저장. 소프트웨어 설치 시 직접 패스워드나 키 입력하도록 설계
6. 취약한 패스워드 요구 조건
 → 패스워드 생성 시 강한 조건 검증

<br>

## 📝 에러 처리

1. 오류 메시지 통한 정보 노출
 → 에러 메시지는 정해진 사용자에게 유용한 최소한의 정보만 표현
2. 오류 상황 대응 부재
 → 오류 발생 가능 부분에 예외 처리 구문. 제어문으로 오류 악용하지 않도록
3. 적절하지 않은 예외처리 
 → 리턴값 있는 함수의 결과값이 기대값인지 모두 검사. 구체적인 예외 처리 구현

<br>

## 📝 세션 통제
 : 다른 세션 간 데이터 공유 금지 등 세션을 안전하게 관리

1. 불충분한 세션 관리
   - 인증 시 일정 규칙이 있는 세션ID를 발급받은 경우
   - 세션 타임아웃이 긴 경우
  → 클래스 설계 시 세션 정보를 읽고 쓰기 가능한 변수로 쓰지 않도록 설계


<br>

## 📝 코드 오류

1. 널 포인터 역참조
    - Null이 될 수 없는 객체가 Null이 됐을 때
    - 널 포인터(메모리 첫 주소)를 참조할 경우
    → Null일 수 있는 것은 참조 전에 Null 검사
2. 정수를 문자로 변환
    - 표현 불가능한 범위 값이 잘려 문자 저장값이 올바르지 않은 경우
    → 변환값의 크기가 변환값이 저장되는 변수 크기보다 크지 않게
3. 부적절한 자원 해제
    - 자원 사용 후 오류로 인해 종료된 자원을 반환하지 않은 경우
    → finally 블록에서 반드시 자원 반환
4. 초기화되지 않은 변수 사용
    - 변수 선언 후 메모리 할당되면 해당 메모리 이전 내용이 남아있을 수 있음
    → 변수 선언 시 할당된 메모리 초기화

<br>

## 📝 캡슐화

1. 잘못된 세션에 의한 데이터 정보 노출
 → 싱글톤 패턴 사용 시 변수 범위에 주의, 멤버변수보다 지역변수 활용해 변수 범위 제한
2. 제거되지 않고 남은 디버그 코드
3. 민감한 데이터 가진 내부 클래스 사용
 → 내부클래스 사용 시 외부클래스의 접근 금지
4. 시스템 데이터 정보 노출
 → 시스템 메시지 통해 노출되는 메시지는 최소 정보만 제공

<br>

## 📝 API 오용

1. DNS Lookup에 의존한 보안 결정
    - 도메인명에 의존해 보안결정 내리는 경우
    - DNS 엔트리를 속여 동일 도메인에 속한 서버인 것처럼 위장한 경우
    - 네트워크 트래픽 유도해 악성 사이트 경유하도록 조작한 경우
    → 도메인명을 이용한 보안결정 DNS Lookup X. IP 주소 이용하기
2. 위험하다고 알려진 함수 사용 (ex. Strcpy 함수)
 → strncpy 함수 사용
3. Null 매개변수 미검사
 → Null 여부 점검

<br><br>

# 📂 시스템 보안 구현

## 📝 유닉스/리눅스 주요 로그 파일

- 유닉스 로그 저장 경로 : /var/adm
- 리눅스 로그 저장 경로 : /var/log

- 유닉스/리눅스 주요 로그 파일
  - wtmp/wtmpx : 사용자 로그인, 로그아웃 정보 → last 명령어 사용
  - utmp/utmpx : 현재 시스템에 로그인한 사용자 정보 → who, users 명령어 사용
  - btmp/btmpx : 로그인에 실패한 정보 → lastb 명령어 사용      
  - lastlog : 사용자별 최근 로그인 정보
  - sulog : su(Switch user) 명령어 실행 결과 정보
  - acct/pacct : 사용자별 실행되는 모든 명령오 로그
  - xferlog : FTP 서비스 데이터 전송 기록 로그
  - messages : 운영 전반의 메시지 저장
  - secure : 보안, 사용자인증 관련 로그

<br>

## 📝 보안 솔루션

1. <b><span style='color:#006DD7'>네트워크 보안 솔루션</span></b>
    - 방화벽 (Firewall)
    - 웹 방화벽 (WAF)
    - 네트워크 접근제어 (NAC; Network Access Control)
    - 침입 방지 시스템 (IDS; Intrusion Detection Sys)
    - 침입 탐지 시스템 (IPS; Intrusion Prevention Sys)
    - 무선 침입 방지 시스템 (WIPS; Wireless IPS)
    - 통합 보안 시스템 (UTM; Unified Threat Management)
    - 가상사설망 (VPN; Virtual Private Network)
2. <b><span style='color:#006DD7'>시스템 보안 솔루션</span></b>
    - 스팸 차단 솔루션 (Anti-Spam Solution)
      - 메일 서버 앞단에 위치해 프록시 메일 서버로 동작
      - 메일 바이러스 검사, 내부 정보 유출 방지
    - 보안 운영체제 (Secure OS)
      - 컴퓨터 운영체제 커널에 보안 기능 추가
3. 컨텐츠 유출 방지 보안 솔루션
    - 보안 USB
    - 데이터 유출 방지 (DLP; Data Loss Prevention)
    - 디지털 저작권 관리 (DRM; Digital Right Management)

<br><br>

# 📂 SW 개발 보안 테스트

- 정적 분석
  - SW를 실행하지 않고 주로 개발 단계에서 분석
  - 장 : 취약점 초기 발견 → 수정비용 절감
  - 단 : 컴포넌트 간 발생 가능한 통합된 취약점 발견에 제약, 설계/구조 관점의 취약점은 식별 불가
- 동적 분석
  - SW를 실행하여 진행, 주로 시험 단계에서 분석
  - 장 : 소스 코드 필요없음, 정확도와 커버리지 향상
  - 단 : 구조 관점의 보안 약점 식별 불가능한

<br><br>

# 📂 비즈니스 연속성 계획 (BCP)
 : 각종 재해, 장애, 재난으로부터 위기관리를 통해 비즈니스 연속성을 보장하는 체계

- BIA (Business Impact Analysis)
 : 장애로 인한 운영 손실 가정하고 BCP를 구축하기 위한 비즈니스 영향 분석
- RTO (Recovery Time Objective)
 : 재해 시 복구 목표 시간 선정 (업무 중단 시점부터 복구까지의 시간)
- RPO (Recovery Point Objective)
 : 재해 시 복구 목표 지점 선정 (업무 중단 시점부터 데이터 정상가동될 때 데이터의 손실 허용 시점)
- DRP (Disaster Recovery Plan)
 : 재난으로 장기간 운영이 불가능한 경우에 대비한 재난 복구 계획
- DRS (Disaster Recovery System)
 : 재해복구계획의 수행을 지원하는 재해 복구 센터
    - Mirror Site
      - 주 센터, 데이터 복구센터 모두 실시간 동시 서비스 가능한 재해 복구 센터
      - RTO = 0
    - Hot Site
      - 주 센터와 동일 수준의 자원을 대기 상태로 원격지에 보유
      - RTO = 4시간 이내
    - Warm Site
      - 재해 복구 센터에서 중요서잉 높은 자원만 부분적으로 보유
      - RTO = 수일~수주
    - Cold Site
      - 데이터만 원격지에 보관, 재해 시 데이터를 바탕으로 필요 자원 조달
      - RTO = 수주~수개월

<br><br>

# 📂 보안 중요 용어

## 📝 보안 공격 관련 용어

- Side Channel Attack
 : 암호화 알고리즘의 물리적 특성 측정해 내부 정보를 부 채널에서 획득
- Drive By Download
 : 불특정 웹에 악성 스크립트 설치, 불특정 사용자 접속 시 동의 없이 멀웨어 서버로 연결해 감염시킴
- Watering Hole
 : 특정인 표적 공격 (특정인이 잘 방문하는 웹사이트에서 유인)
- SCAM
 : 기업 이메일 계정 도용해 무역 거래 대금 가로챔, 사이버 범죄
- HeartBleed
 : OpenSSL 암호화 라이브러리의 Heartbeat 확장 모듈의 취약점 이용
- Crimeware
 : 주요 금융/인증정보 탈취해 금전적 이익 목적으로 하는 범죄행위
- Tor Network
 : 네트워크 경로 알 수 없도록 암호화해서 데이터 전송하며 익명으로 인터넷 사용 가능한 프로토콜
- MITM (Man in the Middle)
 : 두 사람 사이에서 네트워크 통신을 조작해 통신 내용 도청/조작
- DNS Spoofing
 : DNS응답(IP주소)이나 캐시 정보를 조작해 의도하지 않은 주소로 접속하게 함
- Port Scanning
 : 침입 전 대상의 활성화된 포트 확인
- Directory Listing 취약점
 : 인덱싱 기능이 활성화되어 있는 경우, 공격자가 강제 브라우징을 통해 서버 내의 모든 디렉토리 및 파일 목록 볼 수 있는 취약점
- Reverse Shell
 : 타깃 서버가 공격자로 접속해 쉘 획득
- Exploit
 : 버그, 취약점을 이용해 공격자가 의도한 동작 하도록 하는 코드/행위
- Stuxnet
 : 독일 지멘스사의 SCADA 시스템을 공격 목표로 제작된 악성코드 (주요 산업 기반 시설의 제어 시스템에 침투해 오작동 일으킴)
- Credential Stuffing
 : 다른 곳에서 유출된 사용자 계정을 탈취해 공격

<br>

## 📝 보안 공격 대응 관련 용어

- Honeypot
 : 비정상 접근 탐지하도록 일부러 허술하게 만든 유인시스템
- OWASP Top 10
 : 웹 애플리케이션 취약점 10가지에 대한 대응 방안 제공하는 웹 보안 기술 가이드
- Finger Printing
 : 멀티미디어 컨텐츠에 저작권, 정보구매자 정보를 삽입해 불법 배포자 위치 추적
- Water Marking
 : 디지털 컨텐츠에 저작권자 정보 삽입해 원소유자 증명
- 이상금융거래탐지시스템 (FDS; Fraud Detection System)
 : 전자금융거래에 사용되는 정보 분석해 의심 거래 탐지/차단
- CC (Common Criteria)
 : 정보기술의 보안 기능평가 기준, 요구사항 평가하는 국제 평가 기준
- 사이버 위협정보 분석 공유시스템 (C-TAS; Cyber Threats Analysis System)
 : 사이버 위협정보를 체계적으로 수립해 KISA 주관으로 관계 기관과 정보공유
- 장착형 인증 모듈 (PAM; Pluggable Authentication Module)
 : 리눅스 시스템 내 각종 앱 인증을 위해 제공되는 다양한 인증용 라이브러리
- CVE (Common Vulnerabilities and Exposures)
 : 미국 비영리회사 MITRE에서 공개적으로 알려진 SW의 보안취약점 표준화한 식별자 목록
- CWE (Common Weakness Enumeration)
 : 미국 비영리회사 MITRE 중심 SW 공통 약점 분류한 목록
